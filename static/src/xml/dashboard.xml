<templates>
    <!-- L1 Dashboard Page -->
    <t t-name="custom.dashboard" owl="1">
        <div class="dashboard-wrapper">
            <div class="dashboard-container d-flex gap-2 border-2 p-2">
                <!-- Left section - card data -->
                <div class="cards w-33 d-flex flex-column gap-2" style="max-width: 33%;">
                    <div class="card"><h3><t t-esc="state.main_data.sales?.order_count || 0" /></h3><p>SALES ORDER</p></div>
                    <div class="card"><h3><t t-esc="state.main_data.sales?.amount || 0" /></h3><p>SALES</p></div>
                    <div class="card"><h3><t t-esc="state.main_data.sales?.target || 0" /></h3><p>SALES TARGET - Fixed (Year)</p></div>
                    <div class="card"><h3><t t-esc="state.main_data.sales?.target_achievement || 0" /></h3><p>TARGET-ACHIEVEMENT</p></div>
                    <div class="card"><h3><t t-esc="state.main_data.revenue?.amount || 0" /></h3><p>REVENUE Income</p></div>
                    <div class="card"><h3><t t-esc="state.main_data.revenue?.cost_of_revenue || 0" /></h3><p>COST OF REVENUE</p></div>
                    <div class="card"><h3 class="bg-green"><t t-esc="state.main_data.revenue?.gross_profit || 0" /></h3><p>GROSS PROFIT</p></div>
                    <div class="card"><h3 class="bg-green"><t t-esc="state.main_data.revenue?.gross_profit_margin || 0" /></h3><p>GROSS PROFIT MARGIN (%)</p></div>
                    <div class="card"><h3><t t-esc="state.main_data.revenue?.expenses || 0" /></h3><p>EXPENSES</p></div>
                    <div class="card"><h3 class="bg-green"><t t-esc="state.main_data.revenue?.net_profit || 0" /></h3><p>NET PROFIT</p></div>
                    <div class="card"><h3 class="bg-green"><t t-esc="state.main_data.revenue?.net_profit_margin || 0" /></h3><p>NET PROFIT MARGIN (%)</p></div>
                    <div class="card"><h3><t t-esc="state.main_data.revenue?.accounts_receivable || 0" /></h3><p>ACCOUNT RECEIVABLE</p></div>
                    <div class="card"><h3><t t-esc="state.main_data.revenue?.accounts_payable || 0" /></h3><p>ACCOUNT PAYABLE</p></div>
                    <div class="card"><h3><t t-esc="state.main_data.hr?.total_employees || 0" /></h3><p>TOTAL EMPLOYEE</p></div>
                </div>
                
                <!-- Right section - graphs -->
                <div class="graphs w-66 d-grid" style="grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div class="graph-container">
                        <p>
                            <a href="/web#action=my_dashboard.action_l2_dashboard"
                                class="graph_text"
                                style="background-color: lightblue; text-decoration: none; display: inline-block; cursor: pointer;">
                                Sales</a>
                        </p>
                        <div class="graph" id="sales"></div>
                    </div>
                    <div class="graph-container">
                        <p>
                            <a href="/web#action=my_dashboard.action_l2_dashboard"
                                class="graph_text"
                                style="background-color: lightgreen; text-decoration: none; display: inline-block; cursor: pointer;">
                                Cash Flow</a>
                        </p>
                        <div class="graph" id="cash"></div>
                    </div>
                    <div class="graph-container">
                        <p>
                            <a href="/web#action=my_dashboard.action_l2_dashboard"
                                class="graph_text"
                                style="background-color: lightcoral; text-decoration: none; display: inline-block; cursor: pointer;">
                                Revenue</a>
                        </p>
                        <div class="graph" id="revenue"></div>
                    </div>
                    <div class="graph-container">
                        <p>
                            <a href="/web#action=my_dashboard.action_l2_dashboard"
                                class="graph_text"
                                style="background-color: orange; text-decoration: none; display: inline-block; cursor: pointer;">
                                Cost of Revenue</a>
                        </p>
                        <div class="graph" id="expenses"></div>
                    </div>
                </div>
            </div>
        
            <!-- HR Graph Section -->
            <div class="mt-4 mb-4">
                <p class="text-center w-100">
                    <span class="bg-yellow hr_title">Human Resources</span>
                </p>
                <div class="dashboard-hr">
                    <div class="hr-card">
                        <p><span class="graph_text" style="background: #7a7aff;">Total Employee By Department</span></p>
                        <div class="hr-graph" id="department"></div>
                    </div>
                    <div class="hr-card">
                        <p><span class="graph_text" style="background: #7a7aff;">Total Employee By Gender</span></p>
                        <div class="hr-graph" id="gender"></div>
                    </div>
                    <div class="hr-card">
                        <p><span class="graph_text" style="background: #7a7aff;">Employee Count By Category</span></p>
                        <div class="hr-graph" id="category"></div>
                    </div>
                </div>
            </div>
        </div>
    </t>

    <!-- L2 Dashboard Page -->
    <t t-name="custom.l2_dashboard" owl="1">
        <div class="l2-dashboard-container">
            <div t-if="state.isLoading" class="text-center my-5">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
                <p class="mt-2">Loading dashboard data...</p>
            </div>

            <div t-if="!state.isLoading" class="dashboard-content">
                <div class="alert alert-danger" t-if="state.error">
                    <strong>Error:</strong>
                    <t t-esc="state.error" />
                </div>

                <div t-if="!state.error" class="dashboard-wrapper">

                    <div class="row">
                        <div class="card-header bg-primary text-white">
                            <h5 class="card-title mb-0">
                                <i class="fa fa-chart-line me-2" />Sales Overview </h5>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-4 mb-4 px-2">
                            <div class="card shadow-sm h-100">
                                <div class="card-header">
                                    <h5 class="card-title mb-0">Total Sales</h5>
                                </div>
                                <div class="card-body">
                                    <div t-ref="totalSalesChart" class="chart-container"
                                        style="height: 300px;"></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-4 px-2">
                            <div class="card shadow-sm h-100">
                                <div class="card-header">
                                    <h5 class="card-title mb-0">Local Sales</h5>
                                </div>
                                <div class="card-body">
                                    <div t-ref="localSalesChart" class="chart-container"
                                        style="height: 300px;"></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-4 px-2">
                            <div class="card shadow-sm h-100">
                                <div class="card-header">
                                    <h5 class="card-title mb-0">Export Sales</h5>
                                </div>
                                <div class="card-body">
                                    <div t-ref="exportSalesChart" class="chart-container"
                                        style="height: 300px;"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="card-header bg-primary text-white">
                            <h5 class="card-title mb-0">
                                <i class="fa fa-chart-line me-2" />Revenue Overview </h5>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-4 mb-4 px-2">
                            <div class="card shadow-sm h-100">
                                <div class="card-header">
                                    <h5 class="card-title mb-0">Total Revenue</h5>
                                </div>
                                <div class="card-body">
                                    <div t-ref="totalRevenueChart" class="chart-container"
                                        style="height: 300px;"></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-4 px-2">
                            <div class="card shadow-sm h-100">
                                <div class="card-header">
                                    <h5 class="card-title mb-0">Local Revenue</h5>
                                </div>
                                <div class="card-body">
                                    <div t-ref="localRevenueChart" class="chart-container"
                                        style="height: 300px;"></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-4 px-2">
                            <div class="card shadow-sm h-100">
                                <div class="card-header">
                                    <h5 class="card-title mb-0">Export Revenue</h5>
                                </div>
                                <div class="card-body">
                                    <div t-ref="exportRevenueChart" class="chart-container"
                                        style="height: 300px;"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="card-header bg-primary text-white">
                            <h5 class="card-title mb-0">
                                <i class="fa fa-chart-line me-2" />Expenses Overview </h5>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-4 mb-4 px-2">
                            <div class="card shadow-sm h-100">
                                <div class="card-header">
                                    <h5 class="card-title mb-0">Total Expenses</h5>
                                </div>
                                <div class="card-body">
                                    <div t-ref="totalExpensesChart" class="chart-container"
                                        style="height: 300px;"></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-4 px-2">
                            <div class="card shadow-sm h-100">
                                <div class="card-header">
                                    <h5 class="card-title mb-0">Local Expenses</h5>
                                </div>
                                <div class="card-body">
                                    <div t-ref="localExpensesChart" class="chart-container"
                                        style="height: 300px;"></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-4 px-2">
                            <div class="card shadow-sm h-100">
                                <div class="card-header">
                                    <h5 class="card-title mb-0">Export Expenses</h5>
                                </div>
                                <div class="card-body">
                                    <div t-ref="exportExpensesChart" class="chart-container"
                                        style="height: 300px;"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="card-header bg-primary text-white">
                            <h5 class="card-title mb-0">
                                <i class="fa fa-chart-line me-2" />CashFlow Overview </h5>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-4 mb-4 px-2">
                            <div class="card shadow-sm h-100">
                                <div class="card-header">
                                    <h5 class="card-title mb-0">Total CashFlow</h5>
                                </div>
                                <div class="card-body">
                                    <div t-ref="totalCashFlowChart" class="chart-container"
                                        style="height: 300px;"></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-4 px-2">
                            <div class="card shadow-sm h-100">
                                <div class="card-header">
                                    <h5 class="card-title mb-0">Local CashFlow</h5>
                                </div>
                                <div class="card-body">
                                    <div t-ref="localCashFlowChart" class="chart-container"
                                        style="height: 300px;"></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-4 px-2">
                            <div class="card shadow-sm h-100">
                                <div class="card-header">
                                    <h5 class="card-title mb-0">Export CashFlow</h5>
                                </div>
                                <div class="card-body">
                                    <div t-ref="exportCashFlowChart" class="chart-container"
                                        style="height: 300px;"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </t>

    <!-- L4 Dashboard Page -->
    <t t-name="custom.l4_dashboard" owl="1">
        <div class="l4-dashboard-container py-3 px-4">
            <!-- Search Input Field -->
            <div class="mb-3 d-flex">
                <div class="input-group">
                    <span class="input-group-text bg-light">
                        <i class="fa fa-search"></i>
                    </span>
                    <input 
                        type="text" 
                        class="form-control" 
                        placeholder="Search by project or customer..." 
                        t-on-input="(e) => this.handleSearch(e.target.value)"
                        t-ref="searchInput"
                    />
                    <button 
                        class="btn btn-outline-secondary" 
                        type="button"
                        t-on-click="() => this.clearSearch()"
                        t-if="state.searchTerm"
                    >
                        <i class="fa fa-times"></i>
                    </button>
                </div>
            </div>

            <div class="mb-2 p-2 bg-primary text-white fw-bold rounded">Project Delivery Report</div>
            <!-- Dashboard Content -->
            <div class="card shadow-sm">
                <div class="table-responsive">
                    <table class="table table-striped table-hover mb-0 dashboard-table border-bottom">
                        <thead>
                            <tr class="bg-light">
                                <th class="border-end fw-bold cursor-pointer" 
                                    style="position: sticky; left: 0; z-index: 10; background-color: #f8f9fa;"
                                    t-on-click="() => this.handleSort('region')">
                                    Region <span t-esc="this.getSortIndicator('region')" />
                                </th>
                                <th class="border-end fw-bold text-nowrap cursor-pointer"
                                    t-on-click="() => this.handleSort('project')">
                                    Project <span t-esc="this.getSortIndicator('project')" />
                                </th>
                                <th class="border-end fw-bold text-nowrap cursor-pointer"
                                    t-on-click="() => this.handleSort('customer')">
                                    Customer <span t-esc="this.getSortIndicator('customer')" />
                                </th>
                                <th class="border-end fw-bold text-nowrap cursor-pointer"
                                    t-on-click="() => this.handleSort('date')">
                                    Date <span t-esc="this.getSortIndicator('date')" />
                                </th>
                                <th class="border-end fw-bold text-nowrap text-end cursor-pointer"
                                    t-on-click="() => this.handleSort('po_value')">
                                    PO Value <span t-esc="this.getSortIndicator('po_value')" />
                                </th>
                                <th class="border-end fw-bold text-nowrap text-end cursor-pointer"
                                    t-on-click="() => this.handleSort('invoiced')">
                                    Invoiced <span t-esc="this.getSortIndicator('invoiced')" />
                                </th>
                                <th class="border-end fw-bold text-nowrap text-end cursor-pointer"
                                    t-on-click="() => this.handleSort('collected')">
                                    Collected <span t-esc="this.getSortIndicator('collected')" />
                                </th>
                                <th class="border-end fw-bold text-nowrap text-end text-danger cursor-pointer"
                                    t-on-click="() => this.handleSort('pending_collection')">
                                    Pending Collection <span t-esc="this.getSortIndicator('pending_collection')" />
                                </th>
                                <th class="border-end fw-bold text-nowrap text-end cursor-pointer"
                                    t-on-click="() => this.handleSort('outstanding_aging')">
                                    Outstanding Aging <span t-esc="this.getSortIndicator('outstanding_aging')" />
                                </th>
                                <th class="border-end fw-bold text-nowrap text-end cursor-pointer"
                                    t-on-click="() => this.handleSort('vendor_invoice')">
                                    Vendor Invoice <span t-esc="this.getSortIndicator('vendor_invoice')" />
                                </th>
                                <th class="border-end fw-bold text-nowrap text-end cursor-pointer"
                                    t-on-click="() => this.handleSort('payment_made')">
                                    Payment Made <span t-esc="this.getSortIndicator('payment_made')" />
                                </th>
                                <th class="border-end fw-bold text-nowrap text-end cursor-pointer"
                                    t-on-click="() => this.handleSort('payment_to_be_made')">
                                    Payment Pending <span t-esc="this.getSortIndicator('payment_to_be_made')" />
                                </th>
                                <th class="border-end fw-bold text-nowrap text-end text-danger cursor-pointer"
                                    t-on-click="() => this.handleSort('payroll_cost')">
                                    Payroll Cost <span t-esc="this.getSortIndicator('payroll_cost')" />
                                </th>
                                <th class="border-end fw-bold text-nowrap text-end cursor-pointer"
                                    t-on-click="() => this.handleSort('total_outgoing')">
                                    Total Outgoing <span t-esc="this.getSortIndicator('total_outgoing')" />
                                </th>
                                <th class="border-end fw-bold text-nowrap text-end cursor-pointer"
                                    t-on-click="() => this.handleSort('total_margin')">
                                    Total Margin <span t-esc="this.getSortIndicator('total_margin')" />
                                </th>
                                <th class="fw-bold text-nowrap text-end cursor-pointer"
                                    t-on-click="() => this.handleSort('margin_percent')">
                                    Margin % <span t-esc="this.getSortIndicator('margin_percent')" />
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-if="!this.state.main_data.projects">
                                <tr>
                                    <td colspan="16" class="text-center py-4">
                                        <div class="text-muted">
                                            <i class="fa fa-info-circle me-1" /> No projects found matching the current filters
                                        </div>
                                    </td>
                                </tr>
                            </t>

                            <t t-foreach="this.state.main_data.projects || []" t-as="row" t-key="row.project">
                                <tr class="project-row cursor-pointer" t-att-data-project-id="row.id" t-on-click="() => this.openProjectDetails(row.project_id)">
                                    <td class="border-end" style="position: sticky; left: 0; z-index: 5; background-color: inherit;">
                                        <div class="d-flex align-items-center">
                                            <span t-att-class="row.region === 'Local' ? 'badge bg-info me-2' : 'badge bg-success me-2'">
                                                <t t-esc="row.region" />
                                            </span>
                                        </div>
                                    </td>
                                    <td class="border-end fw-medium">
                                        <t t-esc="row.project" />
                                    </td>
                                    <td class="border-end">
                                        <t t-esc="row.customer" />
                                    </td>
                                    <td class="border-end text-nowrap">
                                        <t t-esc="row.date" />
                                    </td>
                                    <td class="border-end text-end">
                                        <t t-esc="row.po_value" />
                                    </td>
                                    <td class="border-end text-end">
                                        <t t-esc="row.invoiced" />
                                    </td>
                                    <td class="border-end text-end">
                                        <t t-esc="row.collected" />
                                    </td>
                                    <td class="border-end text-end fw-bold" t-att-class="row._raw_pending_collection > 0 ? 'text-danger' : ''">
                                        <t t-esc="row.pending_collection" />
                                    </td>
                                    <td class="border-end text-end">
                                        <t t-esc="row.outstanding_aging" />
                                    </td>
                                    <td class="border-end text-end">
                                        <t t-esc="row.vendor_invoice" />
                                    </td>
                                    <td class="border-end text-end">
                                        <t t-esc="row.payment_made" />
                                    </td>
                                    <td class="border-end text-end">
                                        <t t-esc="row.payment_to_be_made" />
                                    </td>
                                    <td class="border-end text-end" t-attf-class="text-danger border-end text-end">
                                        <t t-esc="row.payroll_cost" />
                                    </td>
                                    <td class="border-end text-end">
                                        <t t-esc="row.total_outgoing" />
                                    </td>
                                    <td class="border-end text-end" t-att-class="row._raw_total_margin lt 0 ? 'text-danger' : 'text-success'">
                                        <t t-esc="row.total_margin" />
                                    </td>
                                    <td class="text-end" t-att-class="row._raw_margin_percent lt 0 ? 'text-danger' : 
                                                                                                    (row._raw_margin_percent gte 20 ? 'text-success fw-bold' : '')">
                                        <t t-esc="row.margin_percent" />
                                    </td>
                                </tr>
                            </t>

                            <!-- Totals Row -->
                            <tr class="fw-bold bg-light">
                                <td class="border-end" style="position: sticky; left: 0; z-index: 5; background-color: #f8f9fa;">
                                    <span class="text-uppercase">Totals</span>
                                </td>
                                <td class="border-end" colspan="3">
                                    <t t-esc="this.state.main_data.summary.project_count" />
                                </td>
                                <td class="border-end text-end">
                                    <t t-esc="this.state.main_data.summary.total_po_value" />
                                </td>
                                <td class="border-end text-end">
                                    <t t-esc="this.state.main_data.summary.total_invoiced" />
                                </td>
                                <td class="border-end text-end">
                                    <t t-esc="this.state.main_data.summary.total_collected" />
                                </td>
                                <td class="border-end text-end">
                                    <t t-esc="this.state.main_data.summary.total_pending_collection" />
                                </td>
                                <td class="border-end text-end">
                                    <t t-esc="0" />
                                </td>
                                <td class="border-end text-end">
                                    <t t-esc="this.state.main_data.summary.total_vendor_invoice" />
                                </td>
                                <td class="border-end text-end">
                                    <t t-esc="this.state.main_data.summary.total_payment_made" />
                                </td>
                                <td class="border-end text-end">
                                    <t t-esc="this.state.main_data.summary.total_payment_to_be_made" />
                                </td>
                                <td class="border-end text-end text-danger">
                                    <t t-esc="this.state.main_data.summary.total_payroll_cost" />
                                </td>
                                <td class="border-end text-end">
                                    <t t-esc="this.state.main_data.summary.total_margin" />
                                </td>
                                <td class="border-end text-end">
                                    <t t-esc="this.state.main_data.summary.total_margin" />
                                </td>
                                <td class="text-end" t-att-class="this.state.main_data.summary.avg_margin_percent lt 0 ? 'text-danger' : 
                                                                                                (this.state.main_data.summary.avg_margin_percent gte 20 ? 'text-success fw-bold' : '')">
                                    <t t-esc="this.state.main_data.summary.avg_margin_percent" />
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <!-- Summary and Legend -->
                <div class="p-3 border-top d-flex justify-content-between">
                    <div class="text-muted small">
                        <i class="fa fa-info-circle me-1"></i> Click on any project row to view detailed breakdown
                    </div>
                    <div class="d-flex gap-3">
                        <div class="d-flex align-items-center">
                            <span class="badge bg-info me-1">Local</span>
                            <span class="text-muted small">Domestic Projects</span>
                        </div>
                        <div class="d-flex align-items-center">
                            <span class="badge bg-success me-1">Export</span>
                            <span class="text-muted small">International Projects</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </t>

    <!-- Dashboard Reports -->
    <t t-name="custom.druksmart_dashboard_reports" owl="1">
        <div class="dashboard-wrapper">

            <t t-if="this.props.record.data.category === 'sales'">
                <!-- Sales Report -->
                <div class="mb-2 p-2 bg-primary text-white fw-bold rounded">Sales Report</div>
                <div class="card shadow-sm">
                    <div class="table-responsive">
                        <table class="table table-striped table-hover mb-0 dashboard-table border-bottom">
                            <thead>
                                <tr class="bg-light">
                                    <th class="border-end fw-bold">
                                        Date
                                    </th>
                                    <th class="border-end fw-bold">
                                        Sale Order No
                                    </th>
                                    <th class="border-end fw-bold">
                                        Local/Export
                                    </th>
                                    <th class="border-end fw-bold">
                                        Tags
                                    </th>
                                    <th class="border-end fw-bold">
                                        Customer
                                    </th>
                                    <th class="border-end fw-bold">
                                        Sale Person
                                    </th>
                                    <th class="border-end fw-bold">
                                        Untaxed Amount
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-if="!this.state.main_data.sales">
                                    <tr>
                                        <td colspan="16" class="text-center py-4">
                                            <div class="text-muted">
                                                <i class="fa fa-info-circle me-1" /> No projects found matching the current filters
                                            </div>
                                        </td>
                                    </tr>
                                </t>

                                <t t-foreach="this.state.main_data.sales || []" t-as="row" t-key="row.sale_id">
                                    <tr class="project-row">
                                        <td class="border-end fw-medium">
                                            <t t-esc="row.date" />
                                        </td>
                                        <td class="border-end fw-medium">
                                            <t t-esc="row.sales_order_no" />
                                        </td>
                                        <td class="border-end fw-medium">
                                            <t t-esc="row.local_export" />
                                        </td>
                                        <td class="border-end fw-medium">
                                            <t t-esc="row.tags" />
                                        </td>
                                        <td class="border-end fw-medium">
                                            <t t-esc="row.customer" />
                                        </td>
                                        <td class="border-end fw-medium">
                                            <t t-esc="row.sale_person" />
                                        </td>
                                        <td class="border-end text-end">
                                            <t t-esc="row.untaxed_amount" />
                                        </td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Summary and Legend -->
                    <div class="p-3 border-top d-flex justify-content-between">
                        <div class="text-muted small">
                            <i class="fa fa-info-circle me-1"></i> This report provides a detailed view of sales orders, including local and export sales, along with associated tags and customer information.
                        </div>
                        <div class="d-flex gap-3">
                            <div class="d-flex align-items-center">
                                <span class="badge bg-info me-1">Local</span>
                                <span class="text-muted small">
                                    <t t-esc="this.state.main_data.total_sales_local_untaxed" />
                                </span>
                            </div>
                            <div class="d-flex align-items-center">
                                <span class="badge bg-success me-1">Export</span>
                                <span class="text-muted small">
                                    <t t-esc="this.state.main_data.total_sales_export_untaxed" />
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </t>

            <t t-if="this.props.record.data.category === 'revenue'">
                <!-- Revenue Report -->
                <div class="mb-2 p-2 bg-primary text-white fw-bold rounded">Revenue Report</div>
                <div class="card shadow-sm">
                    <div class="table-responsive">
                        <table class="table table-striped table-hover mb-0 dashboard-table border-bottom">
                            <thead>
                                <tr class="bg-light">
                                    <th class="border-end fw-bold">
                                        Date
                                    </th>
                                    <th class="border-end fw-bold">
                                        Invoice No
                                    </th>
                                    <th class="border-end fw-bold">
                                        Sale Order No
                                    </th>
                                    <th class="border-end fw-bold">
                                        Local/Export
                                    </th>
                                    <th class="border-end fw-bold">
                                        Tags
                                    </th>
                                    <th class="border-end fw-bold">
                                        Customer
                                    </th>
                                    <th class="border-end fw-bold">
                                        Untaxed Amount
                                    </th>
                                    <th class="border-end fw-bold">
                                        Payment Status
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-if="!this.state.main_data.revenues">
                                    <tr>
                                        <td colspan="16" class="text-center py-4">
                                            <div class="text-muted">
                                                <i class="fa fa-info-circle me-1" /> No projects found matching the current filters
                                            </div>
                                        </td>
                                    </tr>
                                </t>

                                <t t-foreach="this.state.main_data.revenues || []" t-as="row" t-key="row.revenue_id">
                                    <tr class="project-row">
                                        <td class="border-end fw-medium">
                                            <t t-esc="row.date" />
                                        </td>
                                        <td class="border-end fw-medium">
                                            <t t-esc="row.invoice_no" />
                                        </td>
                                        <td class="border-end fw-medium">
                                            <t t-esc="row.sales_order_no" />
                                        </td>
                                        <td class="border-end fw-medium">
                                            <t t-esc="row.local_export" />
                                        </td>
                                        <td class="border-end fw-medium">
                                            <t t-esc="row.tags" />
                                        </td>
                                        <td class="border-end fw-medium">
                                            <t t-esc="row.customer" />
                                        </td>
                                        <td class="border-end fw-medium">
                                            <t t-esc="row.untaxed_amount" />
                                        </td>
                                        <td class="border-end text-end">
                                            <t t-esc="row.payment_status" />
                                        </td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Summary and Legend -->
                    <div class="p-3 border-top d-flex justify-content-between">
                        <div class="text-muted small">
                            <i class="fa fa-info-circle me-1"></i> This report provides a detailed view of sales orders, including local and export sales, along with associated tags and customer information.
                        </div>
                        <div class="d-flex gap-3">
                            <div class="d-flex align-items-center">
                                <span class="badge bg-info me-1">Local</span>
                                <span class="text-muted small">
                                    <t t-esc="this.state.main_data.total_local_revenue_untaxed" />
                                </span>
                            </div>
                            <div class="d-flex align-items-center">
                                <span class="badge bg-success me-1">Export</span>
                                <span class="text-muted small">
                                    <t t-esc="this.state.main_data.total_export_revenue_untaxed" />
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </t>

            <t t-if="this.props.record.data.category === 'expense'">
                <!-- Expense Report -->
                <div class="mb-2 p-2 bg-primary text-white fw-bold rounded">Vendor Bills Report</div>
                <div class="card shadow-sm">
                    <div class="table-responsive">
                        <table class="table table-striped table-hover mb-0 dashboard-table border-bottom">
                            <thead>
                                <tr class="bg-light">
                                    <th class="border-end fw-bold">
                                        Date
                                    </th>
                                    <th class="border-end fw-bold">
                                        Bill No
                                    </th>
                                    <th class="border-end fw-bold">
                                        Vendor
                                    </th>
                                    <th class="border-end fw-bold">
                                        Local/Export
                                    </th>
                                    <th class="border-end fw-bold">
                                        Tags
                                    </th>
                                    <th class="border-end fw-bold">
                                        Source Document
                                    </th>
                                    <th class="border-end fw-bold">
                                        Tax Excluded
                                    </th>
                                    <th class="border-end fw-bold">
                                        Payment Status
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-if="!this.state.main_data.expenses">
                                    <tr>
                                        <td colspan="16" class="text-center py-4">
                                            <div class="text-muted">
                                                <i class="fa fa-info-circle me-1" /> No projects found matching the current filters
                                            </div>
                                        </td>
                                    </tr>
                                </t>

                                <t t-foreach="this.state.main_data.expenses || []" t-as="row" t-key="row.expense_id">
                                    <tr class="project-row">
                                        <td class="border-end fw-medium">
                                            <t t-esc="row.date" />
                                        </td>
                                        <td class="border-end fw-medium">
                                            <t t-esc="row.bill_no" />
                                        </td>
                                        <td class="border-end fw-medium">
                                            <t t-esc="row.vendor" />
                                        </td>
                                        <td class="border-end fw-medium">
                                            <t t-esc="row.local_export" />
                                        </td>
                                        <td class="border-end fw-medium">
                                            <t t-esc="row.tags" />
                                        </td>
                                        <td class="border-end fw-medium">
                                            <t t-esc="row.source_document" />
                                        </td>
                                        <td class="border-end text-end">
                                            <t t-esc="row.tax_excluded" />
                                        </td>
                                        <td class="border-end text-end">
                                            <t t-esc="row.payment_status" />
                                        </td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Summary and Legend -->
                    <div class="p-3 border-top d-flex justify-content-between">
                        <div class="text-muted small">
                            <i class="fa fa-info-circle me-1"></i> This report provides a detailed view of sales orders, including local and export sales, along with associated tags and customer information.
                        </div>
                        <div class="d-flex gap-3">
                            <div class="d-flex align-items-center">
                                <span class="badge bg-info me-1">Local</span>
                                <span class="text-muted small">
                                    <t t-esc="this.state.main_data.total_local_expense_untaxed" />
                                </span>
                            </div>
                            <div class="d-flex align-items-center">
                                <span class="badge bg-success me-1">Export</span>
                                <span class="text-muted small">
                                    <t t-esc="this.state.main_data.total_export_expense_untaxed" />
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </t>

            <t t-if="this.props.record.data.category === 'cashflow'">
                <!-- Cashflow Report -->
                <div class="mb-2 p-2 bg-primary text-white fw-bold rounded">Cashflow Report</div>
                <div class="card shadow-sm">
                    <div class="table-responsive">
                        <table class="table table-striped table-hover mb-0 dashboard-table border-bottom">
                            <thead>
                                <tr class="bg-light">
                                    <th class="border-end fw-bold">
                                        Date
                                    </th>
                                    <th class="border-end fw-bold">
                                        Inflow/Outflow
                                    </th>
                                    <th class="border-end fw-bold">
                                        Project
                                    </th>
                                    <th class="border-end fw-bold">
                                        Local/Export
                                    </th>
                                    <th class="border-end fw-bold">
                                        Tags
                                    </th>
                                    <th class="border-end fw-bold">
                                        Source Document
                                    </th>
                                    <th class="border-end fw-bold">
                                        Payment Amount
                                    </th>
                                    <th class="border-end fw-bold">
                                        Payment Status
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-if="!this.state.main_data.cashflows">
                                    <tr>
                                        <td colspan="16" class="text-center py-4">
                                            <div class="text-muted">
                                                <i class="fa fa-info-circle me-1" /> No projects found matching the current filters
                                            </div>
                                        </td>
                                    </tr>
                                </t>

                                <t t-foreach="this.state.main_data.cashflows || []" t-as="row" t-key="row.cashflow_id">
                                    <tr class="project-row">
                                        <td class="border-end fw-medium">
                                            <t t-esc="row.date" />
                                        </td>
                                        <td class="border-end fw-medium">
                                            <t t-esc="row.inflow_outflow" />
                                        </td>
                                        <td class="border-end fw-medium">
                                            <t t-esc="row.project" />
                                        </td>
                                        <td class="border-end fw-medium">
                                            <t t-esc="row.local_export" />
                                        </td>
                                        <td class="border-end fw-medium">
                                            <t t-esc="row.tags" />
                                        </td>
                                        <td class="border-end fw-medium">
                                            <t t-esc="row.source_document" />
                                        </td>
                                        <td class="border-end fw-medium">
                                            <t t-esc="row.payment_amount" />
                                        </td>
                                        <td class="border-end text-end">
                                            <t t-esc="row.payment_status" />
                                        </td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Summary and Legend -->
                    <div class="p-3 border-top d-flex justify-content-between">
                        <div class="text-muted small">
                            <i class="fa fa-info-circle me-1"></i> This report provides a detailed view of sales orders, including local and export sales, along with associated tags and customer information.
                        </div>
                        <div class="d-flex gap-3">
                            <div class="d-flex align-items-center">
                                <span class="badge bg-info me-1">Local</span>
                                <span class="text-muted small">
                                    <t t-esc="this.state.main_data.net_local_cashflow" />
                                </span>
                            </div>
                            <div class="d-flex align-items-center">
                                <span class="badge bg-success me-1">Export</span>
                                <span class="text-muted small">
                                    <t t-esc="this.state.main_data.net_export_cashflow" />
                                </span>
                            </div>
                        </div>
                    </div>
                </div> 
            </t>
        </div>
    </t>
</templates>
